# macro_rules!

Ръждьо предоставя мощна уредба[^system] за макроси, която позволява
метапрограмиране[^metaprogramming]. Както видяхме в предишните глави, макросите
изглеждат като функции, само че завършват накрая с удивителен знак `!`. Но
вместо да създават извикване на функция, макросите биват разгърнати[^expanded]
в изходен код, който се компилира с другия код в програмата. За разлика, обаче,
от макросите в C и други езици, ръждьовите макроси биват разгърнати в
абстрактни[^abstract] правописни дървета, а не просто като предварително
обработени низове (състоящи се от програмен код). Така не ви се случват
неочаквани бъгове, например заради предимството на операторите при извикване.

Макроси се създават с помощтта на макроса `macro_rules!`

```rust,editable
// Това е простичък макрос, наречен `say_hello`.
macro_rules! say_hello {
    // `()` означава, че макросът не приема аргументи.
    () => {
        // Макросът ще се разгърне както е съдържанието на този блок.
        println!("Hello!")
    };
}

fn main() {
    // Това извикване се рагръща като `println!("Hello")`
    say_hello!()
}
```

И така. Защо са полезни макросите?

1. Избягване на повторения (не се повтаряй). Има много случаи, където може да
   ви трябва подобна функционалност на различни места, но с различни типове.
   Често написването на макрос е полезен начин за избягване на повторения в
   кода. (Повече по-късно)

2. Езици с особено предназначение.[^DSL] Макросите позволяват да се
   описва определен правопис за точно определена цел. (Повече по-късно)

3. Взаимодействия с променлив брой аргументи.[^VI] Понякога искате да опишете
   взаимодействие[^interface], което приема различен брой аргументи. Един пример е
   `println!`, който приема различен брой аргументи в зависимост от означенията
   в низа за форматиране. (Повече по-късно)

## Б. пр.

[^system]: уредба (система) – system

[^metaprogramming]: метапрограмиране – metaprogramming. Програмиране на програмирането – създаване на изходен програмен код, чрез програмиране.

[^expanded]: разгърнат (програмен код) – expanded

[^abstract]: отвлечен (за понятие), абстрактен – abstract

[^DSL]: Езици с особено предназначение – Domain-specific languages

[^VI]: Взаимодействия с променлив брой аргументи – Variadic interfaces

[^interface]: взаимодействие (интерфейс) – interface
